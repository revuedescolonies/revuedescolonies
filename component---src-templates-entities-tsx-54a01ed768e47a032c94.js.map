{"version":3,"file":"component---src-templates-entities-tsx-54a01ed768e47a032c94.js","mappings":"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","sources":["webpack://revuedescolonies/./src/templates/tei/Birth.tsx","webpack://revuedescolonies/./src/templates/tei/Entity.tsx","webpack://revuedescolonies/./src/templates/entities.tsx","webpack://revuedescolonies/./src/utils/slugify.ts"],"sourcesContent":["import React from \"react\"\nimport { TBehavior } from \"gatsby-theme-ceteicean/src/components/DefaultBehaviors\"\nimport { TEINodes } from \"react-teirouter\"\nimport { Behavior } from \"gatsby-theme-ceteicean/src/components/Behavior\"\n\ntype TEIProps = {\n  teiNode: Node,\n  availableRoutes?: string[]\n}\n\nconst Birth: TBehavior = (props: TEIProps) => {\n  return (<Behavior node={props.teiNode}><>\n    <TEINodes \n        teiNodes={props.teiNode.childNodes}\n        {...props}/>{' â€“ '}\n  </></Behavior>)\n}\n\nexport default Birth\n","import React from \"react\"\nimport { TEINodes } from \"react-teirouter\"\nimport { Behavior } from \"gatsby-theme-ceteicean/src/components/Behavior\"\nimport { Box } from \"@mui/material\"\n\ntype TEIProps = {\n  teiNode: Node,\n  availableRoutes?: string[]\n  lang: Lang\n  authors: {[key: string]: string}\n}\n\nexport type EntityBehavior = (props: TEIProps) => JSX.Element | null\n\nconst Entity: EntityBehavior = (props: TEIProps) => {\n  const el = props.teiNode as Element\n  // Apparently this needs basic XML DOM functions at build time.\n  const entityContent = Array.from(el.getElementsByTagName('tei-note')).filter(e => e.getAttribute(\"lang\") === props.lang)[0]\n  const resp = entityContent?.getAttribute(\"resp\")\n  const authors = resp?.split(\" \") || []\n  const authorsData = authors.reduce<string[]>((acc, a) => {\n    if (a && a !== \"#other\") {\n      acc.push(props.authors[a.replace(\"#\", \"\")])\n    }\n    return acc\n  }, [])\n  const author = authorsData.length > 0 ? <Box sx={{ fontStyle: \"italic\", textAlign: \"right\", fontSize: \"1rem\" }}>{authorsData.join(\", \")}</Box> : null\n  return (<Behavior node={props.teiNode}><>\n    <TEINodes \n        teiNodes={props.teiNode.childNodes}\n        {...props}/>\n    {author}\n  </></Behavior>)\n}\n\nexport default Entity\n","import React from \"react\";\nimport Layout from \"../components/layout\"\nimport SEO from \"../components/seo\"\nimport { Box, Container, List, ListItem, ListItemText, Typography } from \"@mui/material\"\nimport { Link } from \"gatsby\"\nimport {Routes} from \"gatsby-theme-ceteicean/src/components/Ceteicean\"\nimport Renderer from \"gatsby-theme-ceteicean/src/components/Renderer\";\nimport Q from \"../gatsby-theme-ceteicean/components/Q\";\nimport Graphic from \"../gatsby-theme-ceteicean/components/Graphic\";\nimport { Ref, SafeUnchangedNode } from \"gatsby-theme-ceteicean/src/components/DefaultBehaviors\";\nimport { slugify } from \"../utils/slugify\";\nimport Birth from \"./tei/Birth\";\nimport Entity from \"./tei/Entity\";\n\ninterface repeatCount {\n  section: string\n  count: number\n}\n\ninterface occurenceObj {\n    pageName: string\n    pageLink: string\n    repeats: number\n    sections: repeatCount\n}\n\ninterface Props {\n  pageContext: {\n    language: Lang\n    data: {\n      id: string,\n      name: string,\n      occurrences: occurenceObj[]\n    }\n    elements: string[]\n    prefixed: string\n    authors: {[key: string]: string}\n  }\n}\n\ntype TEIProps = {\n  teiNode: Node,\n  availableRoutes?: string[],\n  curLang: string\n}\n\n\nconst renderRefrences = (references:occurenceObj[], id: string) => {\n\n  const sectionStyle = {\n    paddingLeft: '30px',  // Note: \"paddingLeft\" is camelCase\n  };\n    \n    return (\n      <List>\n        {references.map((refObj:occurenceObj) => (\n          <ListItem>\n            <ListItemText>\n              <Link to={`/${refObj.pageLink}?showEntities=${id}`}>{refObj.pageName} ({refObj.repeats})</Link>\n              {Object.entries(refObj.sections).map(([index, sectionData]) => (\n                <div>\n                  <p style={sectionStyle}>\n                  <Link to={`/${refObj.pageLink}#${sectionData.sectionId}`}>{sectionData.section} ({sectionData.count})</Link>\n                  </p>\n                </div>\n              ))}\n            </ListItemText>\n          </ListItem>\n        ))}\n      </List>\n    )\n}\n\nconst Title = (props: TEIProps) => {\n  const el = props.teiNode as Element\n  const lang = el.getAttribute(\"lang\")\n  if (lang !== props.curLang) return null;\n  return <Typography variant=\"h3\" component=\"h1\" gutterBottom={false} sx={{\n    marginBottom: \"2rem\"\n  }}><SafeUnchangedNode {...props}/></Typography>\n}\n\nexport default function ReferencesPage({pageContext}: Props) {\n  const {language, prefixed, elements, data, authors} = pageContext;\n\n  const routes: Routes = {\n    \"tei-person\": (props) => <Entity lang={language} authors={authors} {...props}/>,\n    \"tei-place\": (props) => <Entity lang={language} authors={authors} {...props}/>,\n    \"tei-org\": (props) => <Entity lang={language} authors={authors} {...props}/>,\n    \"tei-bibl\": (props) => {\n      const el = props.teiNode as Element\n      // Only deal with bibliography bibls.\n      if (el.parentElement?.tagName.toLocaleLowerCase() === \"tei-note\") {\n        return <SafeUnchangedNode {...props}/>\n      }\n      return <Entity lang={language} authors={authors} {...props}/>\n    },\n    \"tei-graphic\": (props) => <Box sx={{textAlign: \"center\"}}><Graphic {...props}/></Box>,\n    \"tei-ref\": Ref,\n    \"tei-q\": (props) => <Q {...props} curLang={language}/>,\n    \"tei-persname\": (props) => <Title {...props} curLang={language}/>,\n    \"tei-orgname\": (props) => <Title {...props} curLang={language}/>,\n    \"tei-placename\": (props) => <Title {...props} curLang={language}/>,\n    \"tei-title\": (props) => {\n      const el = props.teiNode as Element\n      return [\"periodical\", \"legal\"].includes(el.parentElement?.getAttribute(\"type\") || \"\") ? <Title {...props} curLang={language}/>\n      : <SafeUnchangedNode {...props}/>\n    },\n    \"tei-birth\": Birth,\n    \"tei-note\": (props) => {\n      const el = props.teiNode as Element\n      if (el.getAttribute(\"xml:lang\") === language) {\n        return <SafeUnchangedNode {...props}/>\n      }\n      return null\n    }\n  }\n    return (\n      <Layout location={`/${language}/${slugify(data.name)}`}>\n      <SEO title={data.name} lang={\"en\"}/>\n      <Container component=\"main\" maxWidth=\"md\">\n        \n        <Renderer name={data.name} prefixed={prefixed} elements={elements} routes={routes}/>\n        <Typography variant=\"h4\" component=\"h2\" gutterBottom={false} sx={{\n          marginBottom: \"1rem\", marginTop: \"2rem\"\n        }}>{\n          language === \"fr\" ? \"Figure dans\"\n          : \"Appears in\"\n        }</Typography>\n        {renderRefrences(data.occurrences, data.id)}\n      </Container>\n      </Layout>\n    )\n}","export function slugify(text:string) {\n  return text.toLowerCase()\n    .replace(/<[^>]+>/g, '') // remove html tags\n    .replace(/ /g,'-') // spaces become -\n    .replace(/-+/g, '-') // no repeated -\n    .replace(/[^\\p{L}-]+/gu,'') // remove all non word or - characters. TODO: this only saves ASCII characters!\n}"],"names":["props","___EmotionJSX","Behavior","node","teiNode","React","TEINodes","_extends","teiNodes","childNodes","el","entityContent","Array","from","getElementsByTagName","filter","e","getAttribute","lang","resp","authorsData","split","reduce","acc","a","push","authors","replace","author","length","Box","sx","fontStyle","textAlign","fontSize","join","renderRefrences","references","id","sectionStyle","paddingLeft","List","map","refObj","ListItem","ListItemText","Link","to","pageLink","pageName","repeats","Object","entries","sections","_ref","index","sectionData","style","sectionId","section","count","Title","curLang","Typography","variant","component","gutterBottom","marginBottom","SafeUnchangedNode","ReferencesPage","_ref2","pageContext","language","prefixed","elements","data","routes","Entity","_el$parentElement","parentElement","tagName","toLocaleLowerCase","Graphic","Ref","Q","_el$parentElement2","includes","Birth","Layout","location","slugify","name","SEO","title","Container","maxWidth","Renderer","marginTop","occurrences","text","toLowerCase"],"sourceRoot":""}